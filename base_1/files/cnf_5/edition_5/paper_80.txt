Positivity-Preserving Scattered Data Interpolating Surface
using C1 Piecewise Cubic Triangular Patches
Azizan Saaban1, Abd. Rahni Mt. Piah2, Ahmad Abd. Majid3
School of Mathematical Sciences, Universiti Sains Malaysia
11800 USM Pulau Pinang, MALAYSIA
E-mail : 1azizan.s@uum.edu.my, 2arahni@cs.usm.my, 3majid@cs.usm.my
Abstract
The construction of a bivariate C1 interpolant to
scattered data is considered in which the interpolant is
positive everywhere if the original data are positive.
This study is motivated by earlier work in which
sufficient conditions are derived on BÃ©zier points in
order to ensure that surfaces comprising cubic BÃ©zier
triangular patches are always positive and satisfy C1
continuity conditions. Initial gradients at the data sites
are estimated and then modified if necessary to ensure
that these conditions are satisfied. The construction is
local and easy to implement. Graphical examples are
presented using two test functions.

1. Introduction
In [2] and [10], the interpolating surface comprises
cubic BÃ©zier triangular patches with sufficient
conditions imposed on the ordinates of the BÃ©zier
control points in each triangle to guarantee
preservation of positivity. This paper will focus on
relaxing further these sufficient conditions. Various
methods concerning visualization of positive data
which use either piecewise bicubic interpolant or
piecewise cubic triangular interpolant can be found in
the literature, see for examples, [1], [2], [9] and [10]. A
piecewise bicubic function u(x, y) from the data on a
rectangular mesh is constructed in [1], where u(x, y) is
nonnegative
(positive)
everywhere.
Sufficient
conditions for positivity are derived in terms of the
first and mixed partial derivatives at the grid points.
These conditions form a basis of positive interpolation
algorithm. In [2], sufficient non-negative conditions on
the BÃ©zier ordinates are derived to ensure the nonnegativity of piecewise cubic BÃ©zier triangular mesh.
This is done by imposing the same lower bound value
for the edge (other than the vertices) and inner BÃ©zier
ordinates. [10] follows a similar approach as in [2] but

offers more relaxed sufficient conditions which are
easier to compute on the ordinates of the BÃ©zier control
1

points. In both [2] and [10], C non-parametric surfaces
are constructed. Each triangular patch of the
interpolating surface is formed as a convex
combination of three cubic BÃ©zier triangular patches.
An initial value of inner BÃ©zier ordinate in each
triangle is computed using the cubic precision method.
However, the disadvantage of both schemes in [2] and
[10], is that the inner and edge BÃ©zier ordinates are
assigned the same lower bound.
Thus, in this paper, we shall derive sufficient
conditions for the lower bounds of the edge and inner
BÃ©zier ordinates to be adjusted independently while
still ensuring positivity of the triangular patches. We
use a similar approach of construction as in [2] and
[10] but the initial value of inner BÃ©zier ordinate in
each triangle is computed using the cross boundary
derivative along the respective edges as in [6]. This
paper is organized as follows. Sufficient conditions on
BÃ©zier ordinates which will ensure the positivity of
cubic BÃ©zier triangular patches will be described in
Section 2. An outline of the surface construction is
given in Section 3, while Section 4 presents graphical
examples of our proposed scheme. Finally, the
conclusions are given in Section 5.

2. Sufficient
positivity

conditions

to

preserve

Consider a triangle T with vertices V1, V2, V3 and
barycentric coordinates u, v, w such that a point V on
the triangle can be expressed as V=uV1 + vV2 + wV3
where u,v,w Â• 0 and u+v+w = 1. A cubic BÃ©zier
triangular patch P on T is defined as
3
bijk Bijk
(u, v, w)
P(u,v,w) =
(1)

Â¦

i jk 3
i t 0, j t 0 , k t 0

Proceedings of the International Conference on Computer Graphics, Imaging and Visualisation (CGIV'06)
0-7695-2606-3/06 $20.00 Â© 2006

3!
u i v j w k and bijk are the
i! j! k!
BÃ©zier ordinates or control points of P (see Figure 1).

3
where Bijk
(u , v, w)

V1
b300

b210

b201

b120

V2
b030

b111

b021

3y14 + 4(B+C)y13 + 6BCy12 â€“ B2C2 = 0.
(3)
We can show that the real root of (3) for y1 > 0 exists.
Let f(y) = 3y4 + 4(B+C)y3 + 6BCy2 â€“ B2C2. Since f â€™(y)
= 12y3 + 12(B+C)y2 + 12BCy, f is an increasing
function for y1, B and C > 0. Since f(0) = -B2C2 < 0 and
f(B+C) = 7(B+C)4 + BC(6B2+6C2+11BC) > 0, there
exists 0 < y10 < B + C, such that f(y10) = 0 where y10 is
a unique solution of (3) in (0, Â’) as shown in Figure 2.

b102

f

b012

b003
V3

f(B+C)
y = B+C

Figure 1. Control points of cubic triangular patch

We assume that the BÃ©zier ordinates at the vertices
are strictly positive, i.e. b300, b030, b003 > 0. We shall
derive sufficient conditions on the remaining BÃ©zier
ordinates for the entire BÃ©zier patch to be positive.
Note that, in [2] and [10], apart from the BÃ©zier points
at the vertices, all the other BÃ©zier ordinates are
assumed to have the same value. Let us assume b300 =
A, b030 = B, b003 = C where A, B, C > 0. Assume also
b021 = b012 = - y1, b201 = b102 = - y2 , b210 = b120 = -y3
and b111 = -x. Thus, (1) becomes
P(u, v, w) = Au3 + Bv3 + Cw3 - 3y1(v2w + vw2) (2)
3y2(u2w + uw2) - 3y3(u2v + uv2) -6xuvw.
Clearly when x = y1 = y2 = y3 = 0, P(u, v, w) > 0 [10].
Let the boundary curve along the edge V2V3 be
B1(w) = P(0, 1-w, w)
= Bv3 + Cw3 â€“ 3y1(v2w + vw2)
= Bv3 + Cw3 - y1(1- v3- w3)
= (B+y1)(1-w)3 + (C+y1)w3 - y1.
Bâ€™1(w) = -3(B+y1)(1-w)2 + 3(C+y1)w2 = 0 gives
C  y1
1 w
or
us
w
B  y1
B

w

B  y1

.
B  y1  C  y1
It follows that 0 <w Â” 1, implies B1â€™â€™(w) > 0, thus, the
minimum value of B1 is
( B  y1 )(C  y1 )
 y1 . The lower bound of
2
B  y1  C  y1





y1 occurs when the minimum value of B1 equals 0, i.e.
( B  y1 )(C  y1 )
y1 or
2
B  y1  C  y 1
B





f(y)

O
2

-(BC)

y = y10

Figure 2. The unique solution, y10 of f(y) = 0

By following a similar approach for the other two
respective boundary curves, we can find the lower
bounds, y2 and y3 as the positive real roots of the
following equations respectively:
(4)
3y2 4 + 4(A+C)y2 3 + 6ACy2 2 â€“ A2C2 = 0,
(5)
3y3 4 + 4(A+B)y3 3 + 6Aby3 2 â€“ A2B2 = 0.
The lower bound of inner BÃ©zier ordinates, x, can be
obtained as follows:
Let b210 = b120 = b201 = b021 = b012 = -y0, where y0 =
max(y1, y2, y3). Equation (2) can then be written as
P(u, v, w) = Au3 + Bv3 + Cw3 â€“ 3y0(u2v + u2w + v2u +
v2w + w2u + w2v) - 6xuvw = Q(u, v, w) â€“ 6xuvw.
If P(u, v, w) Â• 0 then Q(u, v, w) â€“ 6xuvw Â• 0
Q(u, v, w)
.
(6)
or 0 < x Â”
6uvw
The RHS of (6) is a homogenous function. We can
then use a Lagrange multiplier in order to solve this
problem, i.e. to find x0 = min Q(u,v, w), the lower
bound of x, subject to uvw = 1.
Let F(u, v, w, Èœ) = Q(u, v, w) + Èœ(uvw-1) , where
Èœ is a constant. Thus,
wQ
wQ
wF
wF
 Ovw ,
 Ouw ,
wu
wv
wu
wv
wQ
wF
wF
uvw  1 .
 Ouv and
ww
ww
wO
For minimization of Q, we get
wF
wF
wF
wF
0 , or
wu
wv
ww
wO

Proceedings of the International Conference on Computer Graphics, Imaging and Visualisation (CGIV'06)
0-7695-2606-3/06 $20.00 Â© 2006

wQ
wQ
wQ
v
w
= -Èœ.
(7)
wu
wv
ww
Q(u, v, w) = (A+y0)u3 + (B+y0)v3 + (C+y0)w3 + 5y0,
implies that
wQ
wQ
u
3( A  y 0 )u 3 , v
3( B  y 0 )v 3 and
wu
wv
wQ
3
w
3(C  y 0 ) w .
wu
From (7), we have
3(A+y0)u 3 = 3(B+y0)v3 , 3(A+y0)u 3 = 3(C+y0)w3 and
3(B+y0)v 3 = 3(C+y0)w3 or
B  y0
u3
(8)
3
A  y0
v
u

u3

C  y0
A  y0

w3
v3
w

From (8),

C
B

3

y0
.
y0

B  y0
.
A  y0
( A  y0 ) 3
u and (11) becomes
(C  y 0 )

( B  y 0 )(C  y 0 )
( A  y0 ) 2

2
)9

( A  y0
v

( A  y0

(C  y 0

(B  y0

1
)9

2
)9

(B  y0 ) 9 ( A  y0 ) 9
(C  y 0

,

and

1

1

w

. Hence,

( B  y 0 ) 9 (C  y 0 ) 9

1
)9

(11)

1

1

u

(10)

u 6 w3

From (9), w 3
u9

(9)

2
9
)

.

Thus,
x0 =

Q(u , v, w)
6
1

=

1

1

( A  y 0 ) 3 ( B  y 0 ) 3 (C  y 0 ) 3
5
 y0 .
2
6

(12)

Proposition
Consider the cubic BÃ©zier triangular patch P(u, v,
w) with b300 = A, b030 = B, b003 = C, A, B, C> 0. If b021 ,
b012 Â•- y1, b201, b102 Â•- y2 , b210, b120 Â• -y3 and b111 Â• -x0
(where yi, x0 > 0) such that y1 is the unique solution of
(3), y2 is the unique solution of (4), y3 is the unique
solution of (5) and x0 is given by (12) with y0 =
max(y1, y2, y3), then P(u, v, w) Â• 0 for all u, v, w Â• 0,
u + v + w = 1.
We note that in practice if any of the values of A,
B or C are zero then x0 and y0 are both assigned the
value zero for that triangle.

3. Construction of positivity preserving
interpolating surface
We want to construct a C1 positivity-preserving
functional surface F(x,y) which interpolates a given
scattered data, (xi, yi ,zi ), i=1,2,â€¦,N, where zi > 0. The
surface comprises cubic BÃ©zier triangular patches, each
of which is guaranteed to remain positive. The
construction process follows the steps in [2] and [10]
which consists of the following:
1. Triangulate the domain data (xi, yi),
i=1,2,â€¦,N.
2. Initialise partial derivatives at each data point,
then modify them (if necessary) to be
consistent with the positivity constraints
imposed on the Bezier ordinates.
3. Generate the final surface.
We use Delaunay triangulation [3] to triangulate
the convex hull of the data points. An estimation of the
first order partial derivative of F with respect to x and
y is obtained using the method proposed in [5]. Let
Vi=(xi, yi), i=1, 2, 3 be the vertices of a triangle, such
that F(Vi)= zi, and the first partial derivatives, Fx(Vi)
and Fy(Vi). For each triangular patch P as in (1), the
derivative along the edge ejk joining (xj, yj) to (xk, yk) is
given by
wP
wF
wF
( xk  x j )
.
 ( yk  y j )
we jk
wx
wy
From the given data together with the estimated
derivatives at all the (xi,yi), all the BÃ©zier ordinates brst
except b111 are determined. For example, we have:
1 wF
b300 = F(V1),
b210 F (V1 ) 
(V1 ) and
3 we12
1 wF
the
initial
b201 F (V1 ) 
(V1 ). However,
3 we31
estimate for each edge ordinate may not satisfy the
positivity conditions for P, in view of the Proposition,
we need these BÃ©zier ordinates to fulfill b021, b012 Â• -y1,

Proceedings of the International Conference on Computer Graphics, Imaging and Visualisation (CGIV'06)
0-7695-2606-3/06 $20.00 Â© 2006

b201, b102 Â•- y2, b210, b120 Â• -y3. If it does not, the
magnitudes of Fx, Fy at the vertices need to be reduced
so that the conditions are satisfied. The modification of
these partial derivatives at a vertex Vi, is achieved by
multiplying each derivative at that vertex, by a scaling
factor 0 < È–i < 1, i = 1, 2, 3. The smallest value of È–i is
obtained by considering all triangles that meet at vertex
Vi, which satisfies the positivity conditions of all the
triangles. For example, let Ti, i = 1, â€¦, k be the
triangles of the triangulation which have O as a vertex
(see Figure 3 , where k = 6).
C

D

E
T4

T3
T2

T5
F
T6

O

T1

B

A
Figure 3. Triangles in the triangulation with the
common vertex O

Consider the triangle T1 and the lower bound of
BÃ©zier ordinates adjacent to O on the edge OA and OB
as follows:
Case 1. If O is vertex V1, the lower bound of BÃ©zier
ordinates adjacent to O on edge OA is -y3 and on OB is
-y2.
Case 2. If O is vertex V2, the lower bound of BÃ©zier
ordinates adjacent to O on edge OA is -y1 and on OB is
-y3.
Case 3. If O is vertex V3, the lower bound of BÃ©zier
ordinates adjacent to O on edge OA is -y1 and on OB is
-y2.
It suffices to just consider Case 1 as the other two
cases can be dealt with in a similar manner. Let the
derivatives at O along OA and OB be denoted by
wF
wF
and
, respectively. The scalar È–OA and
weOA
weOB
È–OB are defined as follows:
If F(O) +
È–OA = - 3

1 wF
t  y 3 , then È–OA = 1, otherwise
3 weOA

( F (O)  y 3 )
.
wF
weOA

Similarly, if F (O ) 

1 wF
t  y 2 , then È–OB = 1,
3 weOB

( F (O )  y 2 )
.
wF
weOB
= min{ È–OA, È–OB}. We find

otherwise È–OB = 3

Then

JT

1

JT

i

, i =2,..,k,

for the rest of triangles of the triangulation (as in
Figure 3) by using the same argument above. Finally,
in order that all the BÃ©zier ordinates adjacent to O
fulfill the positivity preserving conditions stated in the
Proposition, let È–1 = min{ J T1 , J T2 , . . ., J T k } . If È–1 <
1, we redefine Fx and Fy at point O respectively as È–1
times the corresponding initial values. By using the
wF
wF
derivatives, (
)(O ) and (
)(O ) , the BÃ©zier
wx
wy
ordinates adjacent to O in Ti are determined. For
wF
we12
example, (b210)j = F (V1 )  J 1
t ( y 3 ) j and
3
wF
we 31
F (V1 )  J 1
t ( y 2 ) j , where
(b201)j =
3
subscript j represents quantities corresponding to
triangle j. Having adjusted these derivatives, if
necessary, the BÃ©zier ordinates are recalculated using
the formulae above. The above process is repeated at
all the nodes, Vi. For each triangle, the inner BÃ©zier
ordinate b111, remains to be calculated, in such a way to
guarantee preservation of positivity and to ensure C1
continuity across patch boundaries. Let T1 and T2 be
two adjacent cubic BÃ©zier triangular patches with a
common boundary curve (see Figure 4). C1 continuity
conditions between two adjacent patches are given by
(13)
c102 = Pb120 + Pb030 + Pb021
c111 = Pb111+ Pb021 + Pb012
(14)
c120 = Pb102+ Pb012 + Pb003
(15)
where (P P P is the barycentric coordinates of W3
with respect to triangle T1. (13) and (15) are
automatically satisfied since the BÃ©zier ordinates b201,
b102, b012, b021, b120, and b210 have already been
obtained.
We shall use similar method as in [6] to determine
i
initial value of inner BÃ©zier ordinate, b111
which is C1
across the boundary ei ,i = 1, 2, 3 where ei is the edge
of the triangle opposite vertex Vi. Local schemes Pi is
i
. The values
defined by replacing b111 in (1) with b111
1
2
3
of inner BÃ©zier ordinates b111
, b111
and b111
for local
schemes P1, P2, and P3 respectively are given by

Proceedings of the International Conference on Computer Graphics, Imaging and Visualisation (CGIV'06)
0-7695-2606-3/06 $20.00 Â© 2006

1
(b120 + b102 + b012 + b021 â€“ b003 â€“ b030)
2
1
2
b111
= (b210 + b102 + b012 + b201 â€“ b003 â€“ b300)
2
1
3
b111 = (b021 + b201 + b120 + b210 â€“ b300 â€“ b030).
2
1
b111
=

(16)
(17)
(18)

vw
uw
and
,
c2
vw  vu  uw
vw  vu  uw
vu
. u, v, w are the barycentric
c3
vw  vu  uw
coordinates of T.
c1

4. Graphical Examples
V3=W2
b003 = c030
b102
b201
V1
b300

c120
b012 = c021

b111

In this section, we will illustrate our interpolating
scheme by using two positive test functions. The first
example [8] comprises 36 data points obtained from
the following function,
c210

c111

W1
c300

T1 b
T2
021 = c012

b210

c201
b120

c102
V2 =W3
b030=c003

Figure 4. Adjacent cubic triangular patches

An initial estimate of the inner BÃ©zier ordinates
given by (16), (17) and (18) in each triangle may not
satisfy the positivity conditions of P(u, v, w) as stated
in the Proposition i.e. b111 Â• -x0. For example, when e1
is a common edge to two triangles as in Figure 3, and
1
1
the initial value b111
or c111
is less than â€“x0, then these
1
ordinates are modified together to ensure that b111
,
1
Â• -x0, and C1 continuity condition along the
c111
common boundary curve between two adjacent patches
given by (14) is satisfied. When e1 is on the boundary
1
1
is
of the domain, and b111
is less than -x0 then b111
2
3
reset to be equal to x0. The ordinates b111
and b111
of
P2 and P3 are adjusted accordingly by using a similar
approach (see [2] for further detail).
The interpolating surface P on the triangle T is
then defined as a convex combination of all the local
schemes so that the sufficient conditions on all sides of
the triangles are satisfied, i.e.
P(u,v,w) = c1P1(u,v,w) + c2P2(u,v,w) + c3P3(u,v,w)
or
3
P (u , v, w)
bijk Bijk
(u , v, w) 

Â¦

i j k 3
i z1, j z1, k z1

if ( y  x) t 0.5
Â­ 1.0
Â° 2( y  x) if 0.5 t ( y  x) t 0.0
Â°
Â°
2
2
Â° cos(4S ( x  1.5)  ( y  0.5)  1
f ( x, y ) Â®
,
2
Â°
1
Â°
if ( x  1.5) 2  ( y  0.5) 2 d 16
Â°
elsewhere on [0, 2] x [0, 1].
Â° 0,
Â¯
Figure 5 shows the surface without imposing the
positivity conditions and can be seen clearly that the
surface actually falls below the xy-plane. When the
positivity conditions are imposed, the interpolating
surface remains positive as shown in Figure 6.
The second example is the function
2

g(x,y) = (x2- 1) ( y2-1)2 , (x,y) Â [-1.4,1.4]x[-1.4,1.4]
taken from [7]. We construct the interpolating suface
using 63 data points from this function. The surface
with no positivity conditions imposed is shown in
Figure 7 and with positivity conditions imposed is
given in Figure 8. Again, part of the surface in Figure 7
is below the xy-plane. After positivity conditions are
imposed, the resulting surface remains positive.

5. Conclusions
In this study, we have considered the generation of
non-parametric surfaces that interpolate positive
scattered data. We imposed very general positivity
conditions on BÃ©zier ordinates which now could be
adjusted independently while still ensuring positivity
of the interpolating surface as compared to the results
in [2] and [10] using cubic triangular patch. This gives
more flexibility to the construction of the interpolating
surfaces.

1
2
3
6uvw(c1b111
 c 2 b111
 c3b111
)

where

Proceedings of the International Conference on Computer Graphics, Imaging and Visualisation (CGIV'06)
0-7695-2606-3/06 $20.00 Â© 2006

Acknowledgements
The authors would like to extend their gratitute to Dr.
Keith Unsworth of Lincoln University, New Zealand
for his valuable suggestions to this study.

Figure 8. Interpolating surface with positivity
conditions imposed on data from g

Figure 5. Interpolating surface with no
positivity conditions imposed on data from f

References
[1]

[2]

[3]

[4]

Brodlie, K. W., Butt, S. and Mashwama, P.,
Visualisation of surface data to preserve positivity
and other simple constraints, Computers and Graphics
19 (1995), 585-594.
Chan, E.S. and Ong, B.H., Range restricted scattered
data interpolation using convex combination of cubic
BÃ©zier triangles, J. Comp. Appl. Math. 136 (2001),
135-147.
Fang, T.P., Piegl, L.A., Algorithms for Delaunay
triangulation and convex-hull computation using a
sparse matrix. Computer Aided Design, 24 (1992),
425-436.
Farin, G., Curves and Surfaces for Computer Aided
th

Figure 6. Interpolating surface with positivity

[5]

conditions imposed on data from f
[6]

[7]

[8]

Geometric Design-A Practical Guide 4 Edition,
Academic Press, San Diego (1996).
Goodman, T.N.T., Said, H.B. and Chang, L.H.T.,
Local derivative estimation for scattered data
interpolation, Appl. Math. Comp. 80 ( 1994), 1-10.
Goodman, T.N.T. and Said, H.B., C1 triangular
interpolant suitable for scattered data interpolation,
Communications in Applied Numerical Methods 7
(1991), 479-485.
Kouibia, A. & Pasadas, M., Variational bivariate
interpolating splines with positivity constraints,
Applied Numerical Mathematics 44 (2003), 507-526
Lancaster, P. & Salkauskas, K., Curve and Surface
Fitting : An Introduction, Academic Press, New York
(1986).
1

[9]

x-y plane
[10]

Figure 7. Interpolating surface with no
positivity conditions imposed on data from g

Ong, B. H. and Wong, H. C., A C positivity
preserving scattered data interpolation scheme, In
Advanced Topics in Multivariate Approximation,
Fontanella, F. et. al. (eds), World Scientific,
Singapore (1996), 259-274.
Piah, A.R.M., Goodman, T.N.T. and Unsworth, K.,
Positivity-preserving scattered data interpolation. In
Mathematics of Surfaces 2005, LNCS 3604, R.
Martin et. al. (eds), Springer-Verlag Berlin
Heidelberg (2005) , 336-349.

Proceedings of the International Conference on Computer Graphics, Imaging and Visualisation (CGIV'06)
0-7695-2606-3/06 $20.00 Â© 2006

