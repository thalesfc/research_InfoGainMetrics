Medical Images Segmentation By Neuro-Genetic Approach
NacÃ©ra Benamrane and Abdelkader Fekir
Vision and Medical Imagery GROUP, SMPA Laboratory, Department of Computer Science
University of Science and Technology of â€œMohamed Boudiafâ€ Oran
B.P 1505 EL-MNAOUER 31000, Oran, Algeria
nabenamrane@yahoo.com.
Abstract
In this paper, we propose an approach based on
the RBF neural networks and the genetic algorithms
for Magnetic Resonance (MR) brain images segmentation. In the feature extraction stage, nine features
are calculated and used as RBF network inputs. The
genetic algorithm build automatically a RBF NN (It
determines the number of hidden neurons, and their
respective centers and radii). Netsâ€™ fitness is calculated by using the mean square error.

Key words: Segmentation, Medical imagery, Regions, RBF, Genetic algorithm.

1. Introduction
The objective of the scene analysis in computer
vision is to develop a symbolic and semantic representation of the information contained at the rough
state in a digital representation with two or three dimensions for recognition and interpretation.
One of the fundamental processes in the visual
recognition chain is the images segmentation. This
process makes it possible to generate a compact description of the image (contours, regionsâ€¦) and thus
symbolic more exploitable than the whole of the pixels, an image being a representation of a universe
made up of entities: objects, cells, etc.
The major object of any segmentation method is
the extraction of visual indices known as "attributes"
characterizing the objects of an image. These attributes correspond to points of interest or zones characteristic of the image: the gray levels of the pixels,
the texture notions, the color, the movement, the
connexity notions, the geometrical parameters (surface, parameter...).
The segmentation being the basic element of any
vision system, many works were consecrate to it.
and discusses the present and possible future role
of neural networks. Among these applications, one
finds sixty applications of segmentation, and SOM
maps are the most used architectures.
In this paper, we use the Radial Basis Function

The diversity of the images, the difficulty of the
problem, the varied origins of the researchers, evolution of the computers power, and a certain empiricism in the results evaluation led to a multitude of
algorithms. [1][2][3]
The segmentation applies to types very different
of images and the techniques vary according to the
studied field. For that, there is no general solution to
the problem, but rather a whole of mathematical and
algorithmic tools which we can combine together to
solve a specific problems. A multitude of segmentation techniques is presented in the literature where
the majority of these techniques are based on one of
the fundamental properties of the gray levels: the
discontinuity and the similarity.
We can classify the various segmentation techniques in three classes [1] [2] [4].
The thresholding or Clustering according to one
or more characteristics. The edge detection is based
on the estimation of local discontinuities of the gray
levels function. In a digital image, contours situated
between the pixels belonging to regions having
different average intensities.
The extraction of regions require the determination of the homogeneous zones (having statistically
similar properties) of the image. Contrary to the
techniques of extraction of edge detection, the segmentation in homogeneous regions is based on the
intrinsic properties of the regions. The choice of
these properties determines the criterion of segmentation
In addition, several works were proposed based
on neural networks for segmentation of the satellite,
medical and different images. A recent article [5]
reviews more than 200 applications of neural networks
in
image
processing
neural networks and the genetic algorithms to segment magnetic resonance images. RBFN are twolayer, feed-forward networks which have as origin
the method RBF whose principle is to approximate a
behavior desired by a collection of the functions.

Proceedings of the Ninth International Conference on Information Visualisation (IVâ€™05)
1550-6037/05 $20.00 Â© 2005 IEEE

Each function is described by two parameters: the
location Ci and width Vi of its center [6] [7] [8].
The genetic algorithms (GA) are algorithms obtained by direct transpositions of the natural evolution process in the world of data processing [9][10].
There are several aspects which intervene in the
use of the genetic algorithms for the development of
artificial neural networks [11] and [12] reviews some
combinations between ANNâ€™s and genetic algorithms
The remainder of this paper proceeds as follows.
Section II.1 details the feature extraction process.
Sections II.2 and II.3 discusses respectively RBF
NNs and genetic algorithms used in our approach.
The labeling step is presented in Section II.4. Segmentation results are reported in Section III and we
finish by a brief conclusion.

2. The proposed Method

Images corpus

Characteristic
extraction

Characteristic
matrix

Initial population
RBFN

â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦

RBFN

Our approach is based on three stages (see fig. 1):
feature extraction stage, the RBF NN used and parameters of the genetic algorithm used in the training
to obtain best RBF NN.
A set of nine attributes defines to extract the characteristics from the images used. We used here the
results of Heather Erin Rickard [13]. He defines a
new algorithm to select the best subset of characteristics (from a set of 23 characteristics) for the medical images segmentation.
The corpus of images is divided into three sets:
one for the training process, another for validation,
and the last to test the generalization power of the
best RBF NN found. The training set is used by the
learning algorithm to compute the weights of the
new NN; the validation set is used to compute the
fitness of individuals.
Then, the population of genetic algorithm is initialized from the training images set, and each
chromosome of this population represents a RBF
NN. For each network (chromosome), the input
weights are computed by using the training images.
To select the best individuals, one calculates the
fitness of each chromosome by using the evaluation
images. Then, the other genetic operations are applied. After a number of generations (criterion of
stop), the optimal network is coded in the best chromosome of the genetic algorithm; It is used to edge
detection of images.

RBFN

2.1. Feature Extraction
Output weights training (SVD)

Genetic
operators

Selection
Crossover
Mutation
Remplacement

No
Stop
criterion
Yes

Optimal RBFN

Images labelling and contours
Detection

The extraction of the characteristics is realized by
measuring certain properties, or features, that distinguish one input pattern from another [14]. The pixels of the gray level image are transformed to a feature vector, and the nine features used here will be
derived from first order gray level parameters, textural measures, and moment invariant features. Once
the features have been obtained for the entire image,
they are ordered into a matrix, where each row
represents all the features for a single pixel, and each
column represents a particular feature for all the pixels in the image.
First order features describe the gray level of a
single pixel or the gray level distribution in a 2D
window, W, of size w x w, centered around the
pixel. In this category, two features were used:
1. The gray level g = I(x,y)
2.
Variance
gray
level
vgl
=

1
(I(x, y)mgl)2
w2 1(x,Â¦
y)ÂW
were mean gray level mgl = =

Fig. 1 Method Steps

1
I(x, y)
w2 (x,Â¦
y)ÂW

A sliding window, w = 8, was used to calculate
the mean and variance for each pixel in the image.

Proceedings of the Ninth International Conference on Information Visualisation (IVâ€™05)
1550-6037/05 $20.00 Â© 2005 IEEE

Textural features are acquired using a statistical
method based on the use of sum and difference histograms, developed by Unser [15]. For a given distance d and a given direction T, the sum histogram is
simply the histogram of the sums of all pixels dx and
dy.
Four features were calculated from these histograms:
3. Mean = 1

i*s(i)
2Â¦
i

Â¦ j *D(j)
2

4. Contrast =

J

5. Homogeneity =

Â¦ j 11*D(j)
2

J

6.Entropy= 

for i= 1...N (N is a number of training examples)
J=1...M (M centers number)
where f is the Gaussian function.
cj function center (hidden neuron) j
xi example i subjected to the network
yi desired output
wj the output weights.
(1) is equivalent with F*W=Y â€¦â€¦.. (2)
By using Singular Value Decomposition method
(SVD) [17] the matrix F becomes
F = U S VT

J

One computes the squared gradient by using a
Gaussian filter of ray V=1
7. LiLi= Lx2 + Ly2 avec Lx = I Â… wGV

wx

The measures introduced by Hu [16] make it possible to define the two moment invariants F1 and F2.
These measures are defined by the following formulas:
The regular moments of an image:

with U(m*m) and V(n*n) are two orthogonal
matrices.
S = diag (s1, s2, â€¦, sn) is a diagonal matrix and
the si are singular values of F.
The matrix W in (2) is calculated by
W=V S* UT Y
were S* =diag(1/s1,1/s2,â€¦..,1/sn)

Â¦Â¦x p yq I(x, y)
x

y

2.3. Genetic algorithm

Central Moments :

m.pq

> f(xi, y j)@*>wj @ >yi @â€¦â€¦â€¦â€¦.. (1)

Â¦S(i).log(S(i)) -Â¦D(j)log(D(j))
i

K.pq

by using a supervised training. That amounts solving
the following equation:

p

q

Â¦Â¦(xx') (y y') I(x, y)
x

y

where x'

K.10
K.00

and y'

K.01
K.00

Normalized moment centrals

P.pq mpq.J

m.00

where

J

pq
1
2

The genetic algorithm that we propose optimizes
the number of Gaussian functions (neurons of the
hidden layer), their centers and their widths. In this
work, each individual represents a RBF NN and the
values of the centers and those of the widths are
stored in chromosome genes (a real vector to represent a center and a real value to represent a width).
The chromosome is defined by:

So,
8. F1 = (P02+P20)
9. F2 = (P30-P12)2+(3P21-P03)2

chi ={{c1,V1}, {c2,V2}, â€¦{ck,Vk}}
with ci is the center of Gaussian function of neu-

2.2. RBF neural networks

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

A NUMBER OF HIDDEN
NEURONS IS VARIABLE

Fig.2 RBF NN architecture used

Ouputs

Proceedings of the Ninth International Conference on Information Visualisation (IVâ€™05)
1550-6037/05 $20.00 Â© 2005 IEEE

Inputs

In our approach, RBF neural network is composed of three layers (see fig. 3). The input layers,
the hidden layer and the output layer. Nine inputs
are used to represent the nine attributes described in
the section II.1. The resulting four outputs of the network are the segmented tissue classes, namely the
CSF (cerebrospinal fluid), cortex (gray matter),
white matter, and background.
The number of the hidden layer neurons, the centers of their Gaussian functions and their widths are
optimized by the genetic algorithm used. Once the
centers number, theirs positions and the widths of
Gaussian fixed, the output weights can be calculated

ron i
Vi its width
k < threshold
This last condition makes it possible to have
chromosomes with different sizes and thus different
hidden neurons of RBF NN.
The chromosomes centers (genes) of the initial
population are selected randomly from the training
corpus, and the widths are initialized by real values
witch are choose randomly in the interval

Âª1, 1
Âº and Nc is the number of chromosome
Â«Â¬
Nc Â»Â¼
centers.
The crossover operator provided a mechanism for
mixer selected chromosomes. It is applied to two
RBF NNs; it takes a random uniformly chosen number of consecutive hidden neurons from first network, and another sequence from the second, and
interchanges the two sequences, no matter if both
sequences have different number of neurons.
Four types of mutation are used: centers mutation,
radii mutation, hidden neuron adder and hidden neuron deleter.
Hidden neuron adder :
This operator duplicates every hidden neuron
with a given probability (the same for all the neuron). One duplicated, the center and width values of
the new neuron are modified using a Gaussian function.
Hidden neuron deleter:
One erases a given percentage of neurons in every
net. Neurons are randomly chosen.
Centers mutation:
This operator changes a given percentage of the
components of the center of every hidden neuron.
Each component of the center is modifier by adding
or subtracting a random value, with mean 0 and
standard 0.1.
ci = ci + Gc
Width Gaussian function mutation:
This operator is applied to one of the existing
nets, but affects to the radii of the RBF. Radii are
modified using a Gaussian function as defined previously. Radii are different for each center, and for
each component of the center.
Vi = Vi + GV
A stage which is preliminary to the crossover and
the mutation operators is the selection process of the
parents (see fig.1). The method used here to select
the best is the Roulette wheel with the integration of
the best chromosome directly in the new population
(Elitism).
Fitness:
with 256x256 resolution. The images of training and
evaluation are manually segmented. Figure 3 shows

The performance of each RBF NN is expressed
by a scalar (the fitness). The fitness makes it possible
Parameter

GA

GA2

1

GA3

Number of
training
4
4
images
Number of
evaluation
8
8
images
P.mut
5%
10%
P.cross
90%
70%
Population
20
12
size
Generations
60
50
number
Number of
optimal
32
23
RBF
NN
centers
Evolution
9h25m
3h 25m 33s
time
32s

2

3
10%
90%
12
50

32

2h 14m 41s

Table.1 Summary of the three genetic algorithms

to obtain a classification sufficiently discriminating
of the individuals.
Netsâ€™ fitness is calculated by using the root mean
square error:

1

fitness =

â€¦..(3)

n 1

1

Â¦ ( yi  o( xi))

2

i 0

n

were yi is the estimated outputs,
O(xi) is the output calculated by the net, and n is
the number of input-output pairs in the validation
set.

2.4 Labeling and edge detection
In this last stage, the best chromosome (RBF NN)
generated by the genetic algorithm is used to detect
edge of the third group images.
For each pixel of image, the corresponding characteristics vector is built and introduced to the input
layer of the optimal network. The output is calculated by using the formula (1), and the class of this
pixel (and the corresponding label) is determinate by
its estimate output.

3. Experiments and results
We used brain MR images (256 gray levels )
an example of image used in this study.
The practical results show that the use of a per-

Proceedings of the Ninth International Conference on Information Visualisation (IVâ€™05)
1550-6037/05 $20.00 Â© 2005 IEEE

centage (| 10%) of the training data is sufficient to
obtain the same results in a reduced execution time.
To test the effects of the GA parameters on the
results obtained, we launched three experiments of
our algorithm and the threshold K is fixed at 32 (K: a
maximum centers number of RBF NN, See section
II.3). A summary on the various parameters used is
given in table 2.
The execution time of the genetic algorithm is
proportional with all the parameters and in particular
the size of population and the generationsâ€™ number.
The results obtained by three optimal RBF NN of
these algorithms are presented in figures 4, 5, 6 and
7. We can note that the results obtained by the GA1
and the GA2 are better than those of the GA3. This
is due to the number of training and evaluation images.

(a) Brain MR image (gray levels) (b) The image (a). segmented
manually
Fig.3 An example of image used in the training

4. Conclusion

[6] C. TOUZET, Â« Les rÃ©seaux de neurones artificiels.
introduction au connexionnisme Â». Juillet 1992
[7] J.-F. Jodouin, Â« Les rÃ©seaux neuromimÃ©tiques modÃ¨les et application Â» Edition HermÃ¨s, Paris 1994.
[8] A.G. Bors Â« Introduction of the Radial Basis Function
(RBF) Networks Â». Department of Computer Science.
University of York. UK 07/2000.
[9] D. Lawrence et M. SteenStrup â€œGenetic algorithms
and simulated annealing: An overview.â€ Edition AddisonWesley. 1994
[10] D. E. Goldberg Â« Algorithmes gÃ©nÃ©tiques Exploration, optimisation et apprentissage automatique Â». Addition
Wesley 1989.D.
[11] White et P. Ligomenides. Â« GANNet : a genetic algorithm for optimizing topology and weights in neural networks design. Â» Computer Science, Vol.686, page322-327,
1993. Proceedings of IWANNâ€™93.
[12] S. A. Billing et G. L. Zheng. Â« Radial basis function
network configuration using genetic algorithms. Neural
Networks, 8(6):877-890,1995.
[13] H. E. Rickard Â« Feature Selection for Self-Organizing
Feature Map Neural Networks with applications in medical image segmentation Â» B.S.E.E., University of Louisville, December 2001.
[14] R. O. Duda and P. E. Hart, Pattern Classification and
Scene Analysis. John Wiley & Sons, New York, 1973.
[15] A. D. Kulkarni Â« Artificial Neural Networks for Image Understanding Â» New York:Van Nostrand Reinhold,
1994.
[16] J. R. Parker Â« Algorithms for Image Processing and
Computer Vision Â» New York:John Wiley & Sons, Inc.,
1997.
[17] F. Rotella et P. Borne Â« MathÃ©matiques thÃ©orie et pratique du calcul matriciel Â». Editions Technip Paris 1995.
pp 92-110.

In this paper, the genetic algorithms and RBF nets
are used for medical images segmentation. The genetic algorithm makes it possible to position the centers of the RBF and to determine their number and
their widths.
The first results demonstrate the use of RBFNNGA as a promising method.
We applied this approach to brain MRI, but it can
be generalized with other types of medical images.

5. References
[1] J.-P. Cocquerez & S. Phillip Â« Analyse dâ€™images :
filtrage et segmentation Â» Edition Masson, Paris, 1995.
[2] R. Horaud & O. Monga Â« Vision par ordinateurs :outils fondamentaux Â» 2e Ã©dition. Edition HermÃ¨s,
Paris, 1993, 1995.
[3] N. Benamrane, K.Kies, J.Shen, Â« Image Segmentation by a Multiresolution Approach Â», EUSIPCO-98,
Signal Processing IX, Theories AND Applications, Vol
IV, September 98.
[4] N. Ayache Â« Lâ€™analyse automatique des images mÃ©dicales: Etat de lâ€™artet perspectives Â» Rapport de recherches de INRIA, fÃ©vrier 1998.
[5] M. Egmont-P. & al. Â« Image processing with neural
networks-a review Â» Pattern Recognition 35 (2002) 2279â€“
2301

Proceedings of the Ninth International Conference on Information Visualisation (IVâ€™05)
1550-6037/05 $20.00 Â© 2005 IEEE

(a)

(b)

Â©
Fig.4 Original images 256x256 (256 grays levels)

(a)

(a)

(b)

(b)

Â©

Â©

Fig.5 The segmented Images by Optimal RBF
NN of the GA1 (table 2 )

Â©
(a)

(b)

(c)
Fig.7 The segmented images by the optimal RBF NN
of the GA3 (table 2 ).

Proceedings of the Ninth International Conference on Information Visualisation (IVâ€™05)
1550-6037/05 $20.00 Â© 2005 IEEE

Fig.6 The segmented images by the optimal RBF
NN of the GA2

