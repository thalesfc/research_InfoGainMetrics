Geometric Control of Rational Cubic Curve
Azhar Ahmad1, Jamaludin Md. Ali2
1
Mathematics Department, Universiti Perguruan Sultan Idris, Tg. Malim, Perak, Malaysia,
2
School of Mathematical Sciences, Universiti Sains Malaysia,11800, Minden, Penang,
azhar@upsi.edu.my, jamaluma@cs.usm.my

Abstract
Geometrical control of curves is discussed in this
paper. The curve representation considered was a
rational Bezier like cubic curve. The rational cubic
curve is characterized by two end points, two end
slopes, a shoulder point and a shoulder line in the case
of inflection. A method is introduced in which the
convexity and inflecting curve is preserved more
intuitively. The paper also shows that the end weights
play a significant role in controlling the shape of the
curve segment constrained by a shoulder point and a
shoulder line.

1. Introduction
In the field of Computer Graphics and Computer
Aided Design, researchers are looking into coming up
with robust algorithm to render curves. One of the
common methods instilled in controlling a curve is by
interpolation. Interpolation of an intermediate point
within a single curve segment has been addressed in a
number of papers, for example [1], [2], [3], [4] and [5].
However the authors did not consider one other aspect
that may be quite significant in curve design, which is
the tangent direction at the intermediate point in a
particular direction. In this paper, it is in the direction
parallel to the chord joining two points. The other
aspect to be considered is an inflecting curve segment
constrained by the intermediate point and a line.
Immediate applications of shape control can be found
in Font Designing [6], Capturing Hand Drawn Images
[7] and in various CAD applications [8].
In curve design, the rational cubic curves can be
considered one of the most powerful tools namely the
rational BÃ©zier being the most popular. [8]. However,
other representation can also be considered. This paper
discusses the alternative representation of curves
which result to easier analysis.

2. Curve segments
intermediate point

interpolating

an

We define a rational BÃ©zier cubic like curve as
F0 (t ) w0 P0  ( F1 (t ) w1  F2 (t ) w 2 ) H  F3 (t ) w3 P3

r (t )

F0 (t ) w0  F1 (t ) w1  F2 (t ) w 2  F3 (t ) w3

(2.1)

with basis functions given by [9],
F0 (t ) (1  t ) 2 (1  (2  D )t )
F1 (t ) D (1  t ) 2 t

F2 (t )

Et 2 (1  t )

(2.2)

2

F3 (t ) t (1  (2  E )(1  t ))

where 0 d t d 1 with w0 , w1 , w2 , w3 being the weights
and Ä® and È• as shape parameters. Without any loss of
generality we assume the endpoints be on the x-axis.
We denote the endpoints by P0 ( x0 ,0) and P3 ( x3 ,0) ,
where x0  x3 . Unit tangent vectors at the endpoints
are given by T0 (m0 , n0 ) and T1 (m1 , n1 ) whereby
T0 , and T1 are not parallel and n1,n0 z 0 . Intermediate
point is symbolized by S x S , y S  . The point of
intersection between the lines made by end tangents
through the respective endpoints is denoted by
H ( x H , y H ) . In our analysis we will use the identity
(4  D ) w0  Dw1  E w2  (4  E ) w3 1
and
a
parameter value t = 0.5 at the intermediate point S.
By letting S ( x S , y S ) W 0 P0  W 1 H  W 2 P3 where
( W 0 ,W 1 ,W 2 ) are the barycentric coordinates of S with
respect to the triangle P0HP3, the following relations
are obtained as shown in [1].

Dw1  Ew2
W
D 4 0

W1

w0

E

4

W2
w3

Proceedings of the International Conference on Computer Graphics, Imaging and Visualization (CGIVâ€™04)
0-7695-2178-9/04 $20.00 Â© 2004 IEEE

(2.3)
(2.4)
(2.5)

Dw1
>0
Ew2

(2.6)

By considering Ä® and È• less or equal to 3, the end
weights w0 and w3 are constrained by,
0  w0 d W 0
(2.7)
0  w3 d W 2
(2.8)
These results will be used in our analysis. The values
W 0 ,W 1 ,W 2 can be obtained from the followings:

W0 =

( x3  x S )n1  m1 y S
( x3  x0 )n1

W1

(m0 n1  m1n0 ) y S
( x3  x0 )n0 n1

(2.9)

( x  x 0 ) n 0  m0 y S
W2= S
( x3  x 0 )n0

2.1. Interpolating the shoulder point
Firstly the shoulder point is defined as a point on
the segment where its tangent is parallel to the chord of
end points. In this paper we will assume that S is a
shoulder point. Figure 1 and Figure 2 illustrate areas
denoted as AL, AR, EL, ER separated by the median
where S should be located. The figures show two
possibility of turning angles of end tangents
namely T0 , T1 .
H

Since S is the shoulder point, then r ' (0.5) , tangent
of the curve at S is parallel to the chord. This indicates
that y ' (0.5) 0 . Taking the derivative of r(t), the ycomponent of r ' (0.5) is,
4n0 n1 ( x0  x3 )[w3 ( w1D (5  E )  w2 E )  w0 (w1D  w2 (5  D )E )]
(m1 n0  m0 n1 )[w0 (4  D )  w1D  w3 (4  E )  w2 E ] 2

(2.10)
When y ' (0.5) 0 , we obtain
w3 ( w1D (5  E )  w2 E )  w0 ( w1D  w2 (5  D ) E ) 0
(2.11)
By substituting D and E given by (2.4) and (2.5) into
(2.3) and (2.11) will give w1 and w2 as:
w1

w0 ( w0  w3  W 0 )W1
(4w0  W 0 )(W 0  W 2 )

(2.12)

w2

w3 ( w3  w0  W 2 )W1
(4 w3  W 2 )(W 0  W 2 )

(2.13)

Hence with reference to the given end weights w0
and w3 , we can construct a curve segment that
interpolates the point S. If we rewrite w0 , w3 in terms
of barycentric coordinates with two scalars P , Q then
from (2.7) and (2.8),
w0 PW 0
(2.14)
w3 QW 2
(2.15)
where 0 < P ,Q d 1. Hence D and E and the weights w1
and w2 can be expressed by ,
1
(2.16)
D 4

P

AL

E

AR

T1

T0
P0

P3
EL

ER

y

0

Figure 1. Turning angle less than 180Â°
AR

AL

T1

T0
P0

P3
EL

ER

y = y0

H

4

1

(2.17)

Q
PW 1 [QW 2  (1  P )W 0 ]
w1
(2.18)
(1  4 P )(W 2  W 0 )
QW 1 [(1  Q )W 2  PW 0 ]
w2
(2.19)
(1  4Q )(W 2  W 0 )
Using w1, w2 , D , E from equations (2.16) to (2.19)
and (2.6) leads to
(1  P )W 0 QW 2

!0
(2.20)
[(1  Q )W 2  PW 0 ]
Therefore to satisfy (2.20) the choice of P and Q
must satisfy the following inequalities,

P

Q
P
 1 and

1 Q 0
P0
W0
where Q 0
and P0
W2


Figure 2. Turning angle less than 180Â°

Proceedings of the International Conference on Computer Graphics, Imaging and Visualization (CGIVâ€™04)
0-7695-2178-9/04 $20.00 Â© 2004 IEEE

Q
1

1

W2
.
W0

(2.21)

The inequalities given by (2.21) together with
0  P d 1 and 0  Q d 1 can be shown by the shaded
region of the rectangular coordinate Q with respect to
P graphs, (Figure 3 and Figure 4). Hence to render a
convex curve interpolating a shoulder point one needs
to only choose any pair P ,Q  within the shaded area.
The different choices between these two figures
depend on different positions of the point S. If S is in
AL, then P ,Q will be chosen from the shaded region
shown in Figure 4. This geometric display helps us to
construct and control a convex curve more intuitively.
Figure 5 illustrates the family of convex curves with
different values of P ,Q  chosen within the shaded
region.

H

S

T0
P3

P0

Q

T1

Figure 5. Curves interpolating S

Q

3. Inflecting curve with shoulder point
1

P 1

-1

P

The Using the same technique as in the previous
section we can find a suitable pair of ( P , Q ) to get an
inflecting curve segment that interpolates the given end
points, end tangents and the shoulder point
respectively. Assuming S in AL , then similar to the
convex case, 0< P d 1 and 0< Q d 1 but

-1

[QW 2  (1  P )W 0 ]
!0
(3.1)
[(1  Q )W 2  PW 0 ]
Hence the range of P and Q that satisfy (3.1) must

Therefore,

Figure 3. Q 0 ! 1, P 0  1,Q 0

1

satisfy

P0

the

P

Q
1
1 Q 0

inequalities,



P
Q

! 1 . The result is illustrated in Figure 6.
P0  1

Q



Q
Q

1

Q

-1

Dw1
 0.
E w2

1

1

P

-1

Figure 4. Q 0  1, P 0 ! 1,Q 0

P

-1

P

1

P

-1

1

P0

Figure 6. Q 0 ! 1, P 0  1, Q 0

Proceedings of the International Conference on Computer Graphics, Imaging and Visualization (CGIVâ€™04)
0-7695-2178-9/04 $20.00 Â© 2004 IEEE

1

P0

and

The family of inflecting curves interpolating the
shoulder point is illustrated in Figure 7.
S

4.1. Derivation of Âµ and Èž
Suppose the segment touching y 0 at t = q where
q z 0.5 . According to the definition of a shoulder line,
y ' ( q ) 0 . Since the parameter t at S is 0.5, then
0.5  q  1 . Since y (q ) = y 0 , then

T0

T1
P0

P3

y0[(1 2q)2(1 q)PW02
 qW2[(1 q)(q Q  2qQ) (1 2q)2QW2]
W0[(1 q)q(1 q  P  2qP)

(4.1)

 (1 2q)2[(1 q)P  qQ]W2]]

Figure 7. A family of inflecting curves
interpolating the shoulder point

In the above analysis we made an assumption that
the end tangents are not parallel. Actually, the results
still hold for parallel end tangents where for this case
W 1 0 and W 0 ,W 2 are computed from equation (2.9).

Similarly when y ' (q ) 0 , then

[(1  q ) 2 P[1  (1  2q ) P ]W 0 2
 [2q 3 ( P  Q )  PQ  2q ( P  2PQ )
2

 q 2Q (1  Q  2qQ )W 2 ]

In this section we will derive a method to generate
an inflecting curve that interpolates a given shoulder
point and touches a given shoulder line. A shoulder
line is defined as a line which is parallel to the chord.
Our aim is to determine the proper values of end
weights w0 and w3 in terms of, Q and P that will
satisfy this constrain.
Let y = y 0 where y 0 < 0 be the shoulder line. For
proper direction of the curve, S must be in AL and the
segment will touch y 0 in E R as illustrated by Figure
8.

S

P0

 (Q  q(1 2Q))W2]] 0

(4.2)

 q 2 (2Q  4P (1  Q ))]W 0W 2

4. Inflecting curve and a shoulder line

T0

[(1 q)qys[(1 q  P  2qP)W0

Solving (4.1) and (4.2), we obtain the value of P and
Q as

P3

y0

Â·
Â§ (1  q ) 2 ( y s  y 0 )
Â¸
Â¨
q  y 0  y s Â¨  y 0 [( 2  6 q  4 q 2 )W 0 Â¸
Â¸
Â¨
Â¸
Â¨  (1  2 q )W 2 ]
Â¹
Â©
2
Â§ 1  2q  2q ( y s  y0 ) Â·
2
Â¸
1  2 q  y 0 W 0 Â¨Â¨
2
Â¸
Â©  y 0 (( 1  2 q ) (W 0  W 2 ) Â¹
2

P

Q

T1

0



,



Â§ q 2 y s  y 0 [(  1  2 q )W 0 Â·
Â¸
(  1  q ) 2  y 0  y s Â¨
Â¨  q (  q  (  2  4 q )W )] Â¸
2 Â¹
Â©
Â§ 1  2q  2q 2 ( y s  y 0 ) Â·
Â¸
1  2 q 2 y 0W 2 Â¨Â¨
2
Â¸
Â©  y 0 ((1  2 q ) (W 0  W 2 ) Â¹





(4.3)

Both values should be in the interval of 0 and 1. Thus
the pair must be in the shaded region shown in Figure
6. To ensure that there is no loop or cusp q should be
in the interval q 0 d q  1 where q 0 is obtained when
P = 1.0

Figure 8. Inflection curves interpolating S and
touching y 0 in the region AL

Proceedings of the International Conference on Computer Graphics, Imaging and Visualization (CGIVâ€™04)
0-7695-2178-9/04 $20.00 Â© 2004 IEEE

This is a rational quadratic curve. The shape of the
curve depends on W Figure 10 illustrates several
quadratic curves with different values of W. The outer
curve is when Wis zero, and the most inner curve is
when it approaches to one. It can be shown that if S
belongs to a semi circular arc, then the curve is a semi
circular arc when W is zero.
S

S

T0

T1
P3

P0

y0

Figure 9. Family of inflection curves
interpolating point S and touching shoulder
line y 0
Figure 10. Several conic sections through S

5. Application
We will illustrate possible applications of this
technique to curve control. Firstly let us rewrite r(t) in
terms of PQ and the barycentric coordinates. If H is
expressed by
H

S  W 0 P0  W 2 P3

Another application is in the design of swept
surface. Let the end points and the shoulder point lies
on three curves in space as shown in Figure 11. Then
we swept conic sections such that the control points lie
on the three curves respectively. Figure 12 illustrates
the swept surface which looks like a bicycle seat.

W1

and substitute the weights and the shape parameters
into equation (2.1) we get
f 0 (t ) P 0  f 1 (t )S  f 2 (t ) P3

r (t)

where
f 0 (t )

(1  t )(1  2t )W 0 ((1  2t ) PW 0


f 2 (t )

(5.1)

h (t )

((1  t ) P  tQ )W 0

t (2t  1)W 2 ((2t  1)QW 2  ((1  t )Q  tP )W 2

Figure 11. Three guiding curves where S lies
on the middle curve

f1 (t ) (1  t )t (1  t  (1  2t )W 0 P )
 ((2t  1)QW 2  t ))

and

h(t ) (1  t )(1  2t )((1  t )(W 0  W 1 )  tW 1 )W 0 ) P
 (t (2t  1)(t (W 2  W 1 )  (1  t )W 1 )W 2 )Q
 t ((1  t ) 2W 0 2  (1  t )tW 2 (W 1  W 2 )
 W 0 (1  t ) 2W 1  (1  t  2t 2 )W 2
This equation holds for all cases of end tangents.
When Wequal toW and P Q then r(t) reduces
to:
r (t )

P0 (1  t1 )(1  t )(1  2t )  2 S (1  t )t  P3 (1  t1 )t ( 2t  1)
(1  t1 )(1  t )(1  2t )  (1  t )t  (1  t1 )t ( 2t  1)

Figure 12. The swept surface of a bicycle seat

Proceedings of the International Conference on Computer Graphics, Imaging and Visualization (CGIVâ€™04)
0-7695-2178-9/04 $20.00 Â© 2004 IEEE

6. Conclusion
We have established a technique that promises the
convexity and infecting cubic curve that satisfies the
criterion given. The geometric displays of the graphs
allow us to determine suitable values of (P,Q). This
will give us an easier, efficient and intuitive method in
the construction and control of planar curves. For
further work it may be interesting to characterise the
rational cubic curve whether it has a single or a double
inflection, a cusp or a loop using the proposed
technique of shape control.

[7] Sarfraz, M, Razak, S, â€ Computing Outlines of Fonts
Using Genetic Algorithm and Splineâ€, Information
Visualization 2001, Proceeding Fifith Int. Conference on, pg.
738 â€“ 743.
[8] Farin, G.E. â€œCurves and Surfaces for Computer Aided
Geometric Designâ€, Academic Press, New York, 1994.
[9] Ali, J.M. â€œAn alternative derivation of Said Basis
Functionsâ€, Sains Malaysiana, Dec 1995, pg. 47-50.

7. Acknowledgements
The authors would like to thank the School of
Mathematical Sciences, Universiti Sains Malaysia for
the support of this work and to the anonymous referee
for suggestions to improve the paper. In this paper the
software (Mathematica version 5.0) is utilized to do
algebraic computation and to render curves and
surfaces.

10. References
[1] Azhar Ahmad, Jamaludin Md. Ali. â€œControlling Rational
Alternative Cubic Curveâ€(in Malay), Jurnal Mathematica,
UTM 2003.
[2] M.A, Jamaludin, H.B, Said and A.A, Majid. â€œShape
Control of Parametric Cubic Curvesâ€, Proceeding of the 4th
International Conference on CAD & CG, Wuhan, China,
161-167.
[3] Sarfraz. M, Hussin, M, Siddiq S.S and Jamaludin M.Ali.
â€œDesigning with Rational Cubic Splinesâ€, Jurnal
PERTANIKA (Special Volume), 2nd International
Conference on the Application of Numerical Methods in
Engineering, (NUMETe-97), UPM, 1997, 520-526.
[4] Sarfaz, M and Razak, M.F.A. â€œAutomatic Outline
Capture of Arabic Fontsâ€, Journal of Information Science,
Elsevier Science Inc. 140(3-4), 269-281.
[5] Sarfraz, M. â€œOptimal Curve Fitting to Digital Dataâ€,
Journal of WSGC, Vol. 11, No. 1, 2003.
[6] Hussain, F. â€œConic Rescue of Bezier Fontsâ€, New
Advances in Computer Graphics. Proceedings of the 4th
KFUPM Workshop on Information and Computer Science:
Internet Computing (WICSâ€™ 2002), Saudi Arabia, 237-251,
2002.

Proceedings of the International Conference on Computer Graphics, Imaging and Visualization (CGIVâ€™04)
0-7695-2178-9/04 $20.00 Â© 2004 IEEE

