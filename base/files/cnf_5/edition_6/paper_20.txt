An Active Contour Model For Selective Segmentation
Wang Wenyuan
Institute of Applied Physics and Computational Mathematics,P.O. Box 8009-16,Beijing 100088,P.R.China

{ wang_wenyuan@iapcm.ac.cn}

Abstract
In this paper, we develop a new active contour
model for image selective segmentation. The model
adopts cascade anisotropic diffusion preprocessing
and a selective term in level set function. Cascade
anisotropic diffusion filtering is powerful and flexible
to enhance image for various segmentation tasks. The
selective term in level set function can evolve a single
curve to capture a selective segmentation region which
we are interested in. This is useful for intentional
segmentation tasks. We can also realize the multiregion segmentation by varying selecting term
conditions. Furthermore, we saliently speed the
process of the new algorithm by using AOS scheme in
cascade anisotropic diffusion filtering and discarding
mean curvature motion in level set function. We
illustrate the performance of our segmentation method
on images generated by different modalities.

1. Introduction
Image segmentation is one of the most important
tasks for the analysis of image data. A variety of
different techniques have been developed to solve the
problem of image segmentation, such as region
growing and emerging [1], watershed algorithms [13] ,
minimum description length criteria [6], MumfordShah energy minimization [8]. Recently PDE-based
active contour models (or curve evolution techniques)
[4] have been popular for image segmentation. Curve
evolution means to evolve deformable contours to
conform to object boundaries for a given image. Lots
of materials had been developed the method for image
segmentation [2,3,4,5,9,12,16,17], we also focus on
the techniques in the paper.
Chan and Vese[3] proposed a level set model for
active contours for image segmentation without using
explicit edge detectors which often use gradient. The
algorithm is based on the Mumford-Shah minimal
partition functional and has two main limitations. One

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV‚Äô05)
0-7695-2392-7/05 $20.00 ¬© 2005 IEEE

is that it can only handle bimodal images. The other is
the computational expense inherent to solving the
proposed nonlinear parabolic partial differential
equations. Through, later, [12] generalized this method
to treat multiple regions, it is also unpractical for real
application. Because it need to solve group of level set
equations for multi-region segmentation.
In this paper, we develop a new active contour
model for image selective segmentation. Selective
segmentation means that we do not try to segment
every region in a level set function evolution, but to
segment the regions which we are interested in. This
can be realized by adopting a selective term in level set
function. The term will produce the essential driving
force for the evolution of the level set function.
Evolving a single curve using level set equation will
capture a selective segmentation region which we are
interested in. If we implement the algorithm for
different conditions, we will get different selective
segmentation region. This realizes the multi-region
segmentation in fact.
Another point of this paper is that we use cascade
anisotropic diffusion filtering as a preprocessing step
before level set function evolving. The cascade
anisotropic diffusion filtering combines Perona-Malik
diffusion model [10] and coherence enhancing
diffusion model [15], can lead good preprocessing
results for image denoising or the grouping of objects
segmentation tasks. Moreover, we use AOS (additive
operator splitting) [14] scheme on the nonlinear
diffusion equation at each time step, this can
remarkably improve the processing efficiency.
The rest of this paper is organized as follows. In
section 2, we review the background. In section 3, we
present the proposal algorithm. In section 4, we show
segmentation results using the new segmentation
technique. Section 5 contains conclusions for this
paper.

2. Background

In this section, we show the foundations of the
Chan and Vese level set implementation of the
Mumford-Shah functional and anisotropic diffusion
filters.

2.1. Active contour without edges
Given a noisy or blurry two-dimensional image
u0 . The Mumford-Shah functional for segmentation is
[8]
2

F (u, C) PL(C)  O ¬≥ (u0  u) d:  ¬≥
:

:\ C

2

¬íu d:

(1)

Where : is image domain and C is segmenting
curve which is the solution by minimum the functional,
O and P are positive parameters, L(C) denotes the
length of C. When the second and third terms separate
the image into different regions, the first term is a
constraint on the curve‚Äôs length and controls its
smoothness.
Chan and Vese [3] discarded the last term of
equation (1) and proposed an algorithm for
decomposing the image into two regions with
piecewise constant approximations. This corresponds
to decomposing the image into regions with respect to
their mean intensity values. In the case of the
piecewise constant approximation and only two
separate regions, the equation (1) can be written in
terms of the level set function as
F (I , c1 , c2 )

wtu

div c¬í u  and c e

¬ß ¬í ( G u )
V
¬®
¬®
k
¬©

2

¬∑
¬∏
¬∏
¬π

2

(4)

where div is the divergence operator, ¬íu is the image
gradient, and c is the diffusion coefficient, k is a
gradient threshold,  means the convolution, GV is a
Gaussian weighted lowpass filter of standard deviation
V, which can be seen as regularization processing
parameter.
The other is coherence enhancing diffusion model
(for shot CED). It combines ideas of nonlinear
diffusion filtering with orientation analysis by means
of the so-called structure tensor (second-moment
matrix, scatter matrix). The basic idea is to smooth a
degraded original image by applying a nonlinear
diffusion process whose diffusion tensor allows
anisotropic smoothing by acting mainly along the
preferred structure direction. This so-called coherence
orientation is determined by the eigenvector of the
structure tensor with the smallest eigenvalue. The CED
model has the expression
wu
wt

¬í ¬ò ( D¬íu )

(5)

where D is the diffusion tensor which can be derived
by the structure tensor analysis, For more details on
coherence enhancing anisotropic diffusion we refer to
[15].

2

P ¬≥ ¬íH (I ) d: O1 ¬≥ (u0  c1 ) H (I )d:
:

:

(2)

2

 O2 ¬≥ (u0  c2 ) (1  H (I ))d:

3. Active Contour Model For Selective
Segmentation

:

Minimizing this functional in the Euler-Lagrange
framework leads to
wI
wt

G H (I )[ P¬í ¬ò ( ¬í¬íII )  O1 (u 0  c1 ) 2  O2 (u 0  c2 ) 2 ] (3)

where ci representing the mean intensity value of the
region labelled i, H is the Heaviside distribution, G can
be Delta function (see [3] for more details).

2.2. Anisotropic diffusion filters
Here we introduce two anisotropic diffusion
models which are applied in this paper. One is Perona
and Malik diffusion model (for short PMD) [10],
Perona and Malik introduced the nonlinear smoothing
expression

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV‚Äô05)
0-7695-2392-7/05 $20.00 ¬© 2005 IEEE

In the section we describe cascade anisotropic
diffusion filter and the whole active contour algorithm
for elective segmentation.

3.1. Cascade anisotropic diffusion filter
The constraint of length scale which corresponds
to the first term in equation (1) is necessary for noisy
images or the grouping of objects segmentation.
Instead of solving for the computationally expensive
motion by mean curvature of equation (3), a possible
preprocessing step to accomplish the constraint of
length scale can be obtained by using a few time steps
of nonlinear diffusion filtering.
For real image processing, only Perona-Malik
diffusion model (in short PMD) or coherence
enhancing diffusion (in short CED) process can not act
good for denoising or the grouping of objects
segmentation tasks. We can combine the two diffusion

model to get a new diffusion model, which is called
cascade anisotropic diffusion. The algorithm of
cascade anisotropic diffusion is: first, to implement
Perona-Malik diffusion, this can enhance the regions
which have small gradient value; second, to implement
coherence enhancing diffusion, this can enhance the
edges or borders which have large gradient value. With
appropriate coefficients and stopping time in the two
steps, we can get good pre-filter results for image
denoising or the grouping of objects segmentation
tasks.
In order to optimize the computational efficiency
of this preprocessing step, we use AOS (additive
operator splitting, see [14] for more details) scheme on
the nonlinear diffusion equation at each time step. The
efficiency and accurateness of AOS scheme are very
suitable for pre-processing for active contour
segmentation.
For denoising task with cascade anisotropic
diffusion filtering, we can choose time step quite great
in both PMD and CED model, then only several
iterative steps can get satisfied results. For the
grouping of objects segmentation, we should still
choose regularization parameter V quite great in PMD
model to get satisfied pre-processing results.

3.2. Level set
segmentation

function

for

selective

Selective segmentation means that we do not try
to segment every region in a level set function
evolution, but to segment the regions which we are
interested in. The selective term level set function
without length scale can be as the following ordinary
differential equation (ODE)
wI
wt

G H (I )(u 0  c1 )(u 0  c2 )

(6)

which obtained by changing  O1 (u0  c1)2  O2 (u0  c2 )2 to
 (u0  c1 )(u0  c2 ) in equation (3) and ignoring the
first (regularization) term. Why make these changes? It
should be noticed that the major driving force for I in
equation (3) is the term  O1 (u 0  c1 ) 2  O2 (u 0  c2 ) 2 .
Rewrite
when O1

the

term

as

c c ¬∑
¬ß
2(c1  c2 )¬® u0  1 2 ¬∏
2 ¬π
¬©

O2 1 . The difference between the image u0

and the average of c1 and c2 is an important
component for the driving force for the level set
function I . Thus, the images u0 must be computed
such that the difference from their average to the

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV‚Äô05)
0-7695-2392-7/05 $20.00 ¬© 2005 IEEE

original image invokes an appropriate and reliable
force for the evolution of the level set function. The
disadvantage of the force is that it finally leads a tworegion segmentation result and can not apply in multiregion segmentation.
In equation (6), the essential driving force for the
evolution
of
the
level
set
function
is
.
The
driving
force
will
be
positive
 (u 0  c1 )(u0  c2 )
for min(c1 , c2 )  u0  max(c1 , c2 ) and negative for

others. So the driving force can finally lead a selective
region segmentation result.
Many methods can be applied in defining c1 and

c2 . In the paper we introduce three methods. For the
two- region segmentation, we can simply get a
c
from
histogram
to
threshold
value
define c1 c, c2 c  E , where E is the appropriate
offset value. For an interested piecewise constant
regions, we apply prior mean of the interested region
to define c1 and c2 . We can get a very rough region of
the interested regions from preprocessing image to
calculate the mean c , then get c1 c  E , c2 c  E ,
where E is appropriate offset value. For a more
simple and powerful method, we only choose c1 is the
approximately smallest value and c2 is the
approximately largest value in the interested region,
then we can get a quite accurate segmentation region
with the level set evolution.

3.3. The proposal active contour model
To integrate above contents, we get a novel active
contour model for selective segmentation. The
algorithm consists of the four steps: 1.implement
preprocessing by cascade anisotropic diffusion
filtering; 2.define c1 and c2 by appropriate method;
3.initialize I as a signed distance function; 4. evolve
the ODE

dI
dt

(u0  c1 )(u0  c2 ) .

With the processes of the new algorithm, evolving
the curve will get a selective segmentation region
which we are interested in. If we implement the
algorithm for different c1 and c2 which come from
appropriate method, we will get different selective
segmentation region. This can realize the multi-region
segmentation in fact.
Standard level set methods are slow because of
time step restrictions and the fact that the spatial terms
need to be evaluated at every time step. Our procedure
improves efficiency in three aspects. The first, we set

G H (I ) 1 in the level set function, this can remarkably
speed the evolution of level set. The second, we use
AOS schemes in cascade anisotropic diffusion preprocessing, it allows to pick up a very great time step
to save pre-processing time with only several iterative
steps. The third, without mean curvature motion in the
level set function, the level set equation (6) does not
require any time step restrictions since an implicit
method could be used.

4. Examples
In all examples, we should notice the most
parameters in PMD and CED are the same when
implementing cascade anisotropic diffusion filtering,
only regularization parameter V and gradient threshold
k in PMD are changed greatly to satisfy various
segmentation tasks.
The first example we consider is a noisy synthetic
ring pattern image with six different gray values (0 , 10,
20, 30, 40, 50) to segment. From the top left to top
right in Fig.1 are the original image, the noisy image
with 100% random noise, the results of PMD and CED
filtering respectively. We show an initial curve in the
pre-processing result of CED filtering. From the
bottom left to bottom right are the segmentation results
with different c1 and c2 as (35,45), (15,55), (5,55),
(5,45) respectively. We can see the different regions
which are defined by c1 and c2 are captured accurately
by the new algorithm. With the pre-processing, the
new algorithm is powerful to resist noise. This
example image is 200u200 pixels size, The CPU times
are about 3 seconds in the pre-processing and 0.5
seconds in the level set function for capturing
calculation on a PC (Pentium IV, 2GeHz). So the
novel algorithm is quite efficient.
In Fig.2-4, the images from left to right show the
original images, cascade anisotropic diffusion filtering
results and initial curves, segmentation results
respectively. We choose c1 and c2 according to
histogram threshold in level set function in the three
examples.
In Fig.2-3, we show that our algorithm can detect
grouping objects and statistical measures efficiently. In
Fig.2, we show the two nearby galaxies to segment as
one cluster result ( V 13 in PMD filtering). Fig.3

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV‚Äô05)
0-7695-2392-7/05 $20.00 ¬© 2005 IEEE

simulates the segmentation of the location of a
simulated mine-field. We use V 8 in PMD filtering.
In Fig.4, we show the segmentation task in the heart
image. Note that we use the area term in addition, to
force the initial curve to move only ‚Äúinside‚Äù.
In Fig.5, we show the brain image segmentation.
Again, we use a large regularization parameter V 10
in PMD filtering to get a pre-processing result at top
middle in Fig.5, so we captures the big brain region
first at top right in Fig.5. Then we use a small V 1 in
PM model to get an enhancing result at bottom right in
Fig.5 for selective segmentation tasks. We execute
level sets function evolution three times for selective
segmentation with c1 and c2 as (-10,110), (110,170),
(170,270) respectively ( c1 and c2 can be derived by
rough mean calculation). We show the piece-wise
constant reconstruction result which includes black,
gray and white regions at bottom middle in Fig.5.

5. Conclusions
We have developed a new active contour model
for image segmentation. The model is an extension of
active contour based on level set functions. There are
two aspects to improve conventional models. One is
using cascade anisotropic diffusion filtering as
preprocessing step, it is powerful to enhance image
and get the segmentation results such as the grouping
of objects segmentation. Meanwhile, as a preprocessing step will show more efficient than coupling
computation in level set function evolution. The other
is that we adopt a selective term in level set function,
evolving a single curve using level set equation will
capture a selective segmentation region which we are
interested in. The examples show the accuracy and
efficiency for various segmentation tasks by the
proposal algorithm.

Fig.1. Ring pattern image with different intensities

Fig.2. Segmentation of two nearby galaxies

Fig.3. Segmentation of a simulated mine-field

Fig.4. Segmentation of heart image

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV‚Äô05)
0-7695-2392-7/05 $20.00 ¬© 2005 IEEE

Fig.5. Segmentation of brain image

6. References
[1] R. Adams, L. Bischof, Seeded region growing, IEEE
Transactons on Pattern Analysis and Machine Intelligence,
16(6), 1994.
[2] V. Caselles, R. Kimmel, and G. Sapiro. Geodesic
Snakes. International Journal of Computer Vision, 22:61-79,
1997.
[3] T. Chan and L. Vese. Active Contours Without Edges.
IEEE Tran. on Image Processing, vol 10(2), pp 266-277,
2001.
[4] M. Kass, A. Witkin and D. Terzopoulos, Snakes: Active
Contour Models, Int. J. Comput. Vision, Vol. 1, 321-331,
1988

[10] P. Perona. and J. Malik. Scale-Space and Edge
Detection Using Anisotropic Diffusion. IEEE Transactions
on Pattern Analysis and Machine Intelligence, 12 (1), 629639, 1990.
[11] J. A. Sethian, Level Set Methods and Fast Marching
Methods, Second Edition, Cambridge University Press,
Cambridge, UK, 1999.
[12] L. Vese and T. Chan, A Multiphase Level Set
Framework for Image Segmentation Using the Mumford and
Shah Model, International Journal of Computer Vision 50
(3), 271-293, 2002.
[13] L.Vincent and P.Soille, Watersheds in digital spaces ‚Äì
An efficient algorithm based on immersion, IEEE Trans.
Pattern Alal. And Machine Learning, Vol. 6, 583-598, 1991

[5] L. Cohen, ‚ÄúOn active contour models and balloons‚Äù,
CVGIP:Image understanding, vol. 53, No. 2, March, 1991.

[14] J. Weickert, B. Romeny and M. Viergever. Efficient
and Reliable Scheme for Nonlinear Diffusion Filtering. IEEE
Transactions on Image Processing, 7 (3), 398-410, 1998.

[6] Y. Leclerc, ‚ÄúRegion growing using the MDL principle‚Äù,
in DAPPRA image understanding workshop,1990.

[15] J. Weickert. Coherence-enhancing Diffusion Filtering.
Int J. Comput. Vision, Vol. 31, 111-127, 1999.

[7] R. Malladi, J, Sethian, and B. Vemuri. Shape Modeling
with Front Propagation: A Level Set Approach. IEEE Trans.
on Signal Processing, 41(12), pp 3377-3396, 1993.

[16] Chenyang Xu and Jerry L. Prince, Gradient Vector
Flow: A New External Force for snakes, IEEE proc. Conf. on
Comp. Vis. Patt. Recog. 66-71, 1997

[8] D. Mumford and J. Shah. Optimal Approximation by
Piecewise Smooth Functions and Associated Variational
Problems. Communication in Pure and Applied Mathematics,
42 (1), 577-685, 1989.

[17] A. Yezzi, A.Tsai and A. Willsky, A Fully Global
Approach to Image Segmentation via Coupled Curve
Evolution Equations, Journal of Visual Communication and
Image Representation, 13, 195-216, 2002.

[9] N.Paragios and R Deriche. Coupled Geodesic Active
Regions for Image Segmentation : a level set approach. Proc.
of 6th European Conference on Computer Vision, volume II,
pages 224-240, 2000.

Proceedings of the Computer Graphics, Imaging and Vision: New Trends (CGIV‚Äô05)
0-7695-2392-7/05 $20.00 ¬© 2005 IEEE

